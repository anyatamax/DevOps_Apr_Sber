# DevOps_Apr_Sber

### –ó–∞–¥–∞–Ω–∏–µ ‚Ññ1  
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–µ –≤–µ–± –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –¥–≤–∞ endpoint‚Äô–∞ :   
* GET /time - —ç—Ç–æ—Ç endpoint –¥–æ–ª–∂–µ–Ω –æ—Ç–¥–∞–≤–∞—Ç—å —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è  
* GET /statistics - —ç—Ç–æ—Ç endpoint –¥–æ–ª–∂–µ–Ω –æ—Ç–¥–∞–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ endpoint‚Äô—É /time –≤ –≤–∏–¥–µ –æ–¥–Ω–æ–≥–æ —á–∏—Å–ª–∞. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∏ –æ—Ç–¥–∞–≤–∞—Ç—å —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∑–∞–ø—Ä–æ—Å—É.   
–î–∞–ª–µ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ endpoint‚Äô—É GET /statistics –∏ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ñ–∞–π–ª. –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è —Ä–∞–∑ –≤ 5 —Å–µ–∫—É–Ω–¥.  

–í—Å–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –≤—ã—à–µ –¥–æ–ª–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –≤ Kubernetes. –î–ª—è —ç—Ç–æ–≥–æ –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:   
–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ —Å–∫—Ä–∏–ø—Ç(docker –æ–±—Ä–∞–∑—ã)  
–Ω–∞–ø–∏—Å–∞—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –¥–ª—è —ç—Ç–∏—Ö –¥–≤—É—Ö –æ–±—Ä–∞–∑–æ–≤  
bash —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–æ–≤ –∏ –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ–≥–æ –≤–Ω—É—Ç—Ä–∏ Kubernetes  

–í readme –ø—Ä–æ–µ–∫—Ç–∞ –æ–ø–∏—à–∏—Ç–µ –∫—É–¥–∞ –Ω–∞–¥–æ —Å–¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç  

### –†–µ–∑—É–ª—å—Ç–∞—Ç  
–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–µ–æ–±–æ—Ö–æ–¥–∏–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å minikube:  
minikube start   
–ó–∞–ø—É—Å–∫–∞–µ–º start.sh  
./start.sh  
–í —Å–æ—Å–µ–¥–Ω–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å:  
minikube service app-service  
–í—ã–≤–æ–¥:  
üèÉ  Starting tunnel for service app-service.  
|-----------|-------------|-------------|------------------------|  
| NAMESPACE |    NAME     | TARGET PORT |          URL           |  
|-----------|-------------|-------------|------------------------|  
| default   | app-service |             | http://127.0.0.1:50765 |  
|-----------|-------------|-------------|------------------------|  
üéâ  Opening service default/app-service in default browser...  
‚ùó  Because you are using a Docker driver on darwin, the terminal needs to be open to run it.   

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:  
curl http://127.0.0.1:50765/time  (url –∏–∑ –∫–æ–¥–∞ –≤—ã—à–µ)   
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:  
curl http://127.0.0.1:50765/statistics  (url –∏–∑ –∫–æ–¥–∞ –≤—ã—à–µ)   
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–∞–π–ª–∞ statistics.txt –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:  
kubectl cp statistics-client-56c46664bf-r64rl:statistics.txt ./statistics.txt (–Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∞ statistics-client –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –∏–∑ –∫–æ–º–∞–Ω–¥—ã kubectl get pods -o wide)  

--------------------------------------------------------------------------------------------------------------------------------------------------------------
### –ó–∞–¥–∞–Ω–∏–µ 2

–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ Istio. –î–ª—è —ç—Ç–æ–≥–æ:  
* –Ω–∞–ø–∏—Å–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Istio –≤ –≤–∞—à–µ–º –∫–ª–∞—Å—Ç–µ—Ä–µ, –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ª–µ–π–±–ª–æ–≤ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã Istio –Ω–∞—á–∞–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–Ω–µ–¥—Ä—è—Ç sidecat –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∫ –≤–∞—à–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º –≤ Kubernetes. –¢–∞–∫–∂–µ, –≤ —ç—Ç–æ–º —Å–∫—Ä–∏–ø—Ç–µ, –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Istio –≤ –≤–∞—à–µ–º –∫–ª–∞—Å—Ç–µ—Ä–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø—Ä–µ—â–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–π —Ç—Ä–∞—Ñ–∏–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–≤.  
* –Ω–∞–ø–∏—Å–∞—Ç—å –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã, —á—Ç–æ–±—ã —Ç–µ–ø–µ—Ä—å –≤–µ—Å—å –≤—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ —à–µ–ª —á–µ—Ä–µ–∑ Ingress Gateway  
* —Ç–µ–ø–µ—Ä—å –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –Ω–∞ endpoint GET /time –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –æ–Ω–æ –¥–æ–ª–∂–Ω–æ –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ http://worldtimeapi.org/api/timezone/Europe/Moscow –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è datetime –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ –≤—ã—à–µ.  
* —Å–æ–∑–¥–∞—Ç—å –º–∞–Ω–∏—Ñ–µ–π—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–∑—Ä–µ—à–∞—é—Ç –≤–Ω–µ—à–Ω–∏–π —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ worldtimeapi.org  
* –≤ readme –ø—Ä–æ–µ–∫—Ç–∞ –æ–ø–∏—à–∏—Ç–µ –∫—É–¥–∞ –Ω–∞–¥–æ —Å–¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç(–æ—Å—Ç–∞–≤–∏—Ç—å —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è, –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–µ–Ω—è–ª–æ—Å—å).

### –†–µ–∑—É–ª—å—Ç–∞—Ç  
–ê–ª–≥–æ—Ä–∏—Ç–º —Ç–∞–∫–æ–π –∂–µ —á—Ç–æ –∏ –≤ –ó–∞–¥–∞–Ω–∏–∏ ‚Ññ1  


--------------------------------------------------------------------------------------------------------------------------------------------------------------
### –ó–∞–¥–∞–Ω–∏–µ 3  

–¢–µ–ø–µ—Ä—å –±—É–¥–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –î–ª—è —ç—Ç–æ–≥–æ:   
* –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ Prometheus Operator —Å–æ –≤—Å–µ–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞–º–∏. –î–ª—è —ç—Ç–æ–≥–æ –¥–æ–±–∞–≤—å—Ç–µ –≤ —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã –∏ –¥–æ–ø–∏—à–∏—Ç–µ –≤  —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –∫–æ–º–∞–Ω–¥—ã, —á—Ç–æ–±—ã –Ω–æ–≤—ã–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã —Ç–æ–∂–µ –ø—Ä–∏–º–µ–Ω—è–ª–∏—Å—å –∫ –∫–ª–∞—Å—Ç–µ—Ä—É.  
* —Å–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π prometheus exporter(–æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ö–æ–¥–∏—Ç—å –Ω–∞ endpoint /statistics –∏ —Å–æ–±–∏—Ä–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏, –∞ –∑–∞—Ç–µ–º –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å —ç—Ç–æ –≤ —Ñ–æ—Ä–º–∞—Ç, –ø–æ–Ω—è—Ç–Ω—ã–π Prometheus. –°–≤–æ—é –Ω–æ–≤—É—é –º–µ—Ç—Ä–∏–∫—É –º–æ–∂–µ—Ç–µ –Ω–∞–∑–≤–∞—Ç—å request_count  
* –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ Prometheus –≤ –≤–∞—à–µ–º –∫–ª–∞—Å—Ç–µ—Ä–µ, —á—Ç–æ–±—ã –æ–Ω –∑–Ω–∞–ª –ø—Ä–æ –≤–∞—à –Ω–æ–≤—ã–π exporter –∏ –∑–∞–±–∏—Ä–∞–ª –æ—Ç—Ç—É–¥–∞ –º–µ—Ç—Ä–∏–∫–∏  

### –†–µ–∑—É–ª—å—Ç–∞—Ç  
–ê–ª–≥–æ—Ä–∏—Ç–º —Ç–∞–∫–æ–π –∂–µ —á—Ç–æ –∏ –≤ –ó–∞–¥–∞–Ω–∏–∏ ‚Ññ1  (–∫—Ä–æ–º–µ –ø–æ–ª—É—á–µ–Ω–∏ —Ñ–∞–π–ª–∞ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–º–∏)  

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –ª–æ–∫–∞–ª—å–Ω–æ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å:  
mkdir data  
minikube mount data:/data  
–¢–æ–≥–¥–∞ —Ñ–∞–π–ª —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–º–∏ –ø–æ—è–≤–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ data  

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–≤–µ—Å—Ç–∏:  
minikube service app-exporter-service  
üèÉ  Starting tunnel for service app-exporter-service.  
|-----------|----------------------|-------------|------------------------|  
| NAMESPACE |         NAME         | TARGET PORT |          URL           |  
|-----------|----------------------|-------------|------------------------|  
| default   | app-exporter-service |             | http://127.0.0.1:56470 |  
|-----------|----------------------|-------------|------------------------|  
üéâ  Opening service default/app-exporter-service in default browser...    
—Ç–∞–º –±—É–¥—É—Ç –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ —Å–µ—Ä–≤–∏—Å—É  
–∏–ª–∏ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É:  
curl http://127.0.0.1:56470 | grep "^request_count" (–≥–¥–µ –ø–æ—Ä—Ç –∏–∑ –≤—ã–≤–æ–¥–∞ –≤—ã—à–µ)
